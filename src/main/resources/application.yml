spring:
  application:
    name: VerYGanaAPI
  config:
    import: optional:file:.env[.properties]

  # =====================
  # DATABASE CONFIGURATION
  # =====================
  datasource:
    # Para Railway (PostgreSQL) - usa variables de entorno
    url: ${DATABASE_URL:jdbc:mysql://localhost:3306/verygana?useSSL=false&serverTimezone=America/Bogota}
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD:1234}
    driver-class-name: ${DB_DRIVER:com.mysql.cj.jdbc.Driver}

  # =====================
  # JPA/HIBERNATE CONFIGURATION
  # =====================
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    properties:
      hibernate:
        format_sql: true
        dialect: ${HIBERNATE_DIALECT:org.hibernate.dialect.MySQL8Dialect}
        jdbc:
          time_zone: America/Bogota

  # =====================
  # MULTIPART/FILE UPLOAD
  # =====================
  servlet:
    multipart:
      enabled: true
      max-file-size: 100MB
      max-request-size: 100MB
      file-size-threshold: 2MB
      # max-file-count: 20

# ============================================
# JWT CONFIGURATION
# ============================================
rsa:
  private-key: classpath:certs/private.pem
  public-key: classpath:certs/public.pem

commissions:
  ad-commission: 0.1
  

jwt:
  access-token:
    expiration: 86400      # 1 day (in seconds)
  refresh-token:
    expiration: 604800     # 7 days (in seconds)

# ============================================
# STORAGE CONFIGURATION
# ============================================
storage:
  provider: cloudinary  # Options: cloudinary, r2

# =====================
# CLOUDINARY (Development)
# =====================
cloudinary:
  cloud-name: ${CLOUDINARY_CLOUD_NAME}
  api-key: ${CLOUDINARY_API_KEY}
  api-secret: ${CLOUDINARY_API_SECRET}

# =====================
# CLOUDFLARE R2 (Production - Future)
# =====================
cloudflare:
  r2:
    account-id: ${R2_ACCOUNT_ID:your-account-id}
    access-key-id: ${R2_ACCESS_KEY_ID}
    secret-access-key: ${R2_SECRET_ACCESS_KEY}
    bucket-name: ${R2_BUCKET_NAME:verygana-campaigns}
    cdn-domain: ${R2_CDN_DOMAIN:} # Opcional: cdn.verygana.com
    endpoint: ${R2_ENDPOINT:} # Opcional, se construye automáticamente

# Configuración de limpieza de huérfanos
cleanup:
  orphaned-assets:
    enabled: true
    cron: "0 0 2 * * ?" # Cada día a las 2 AM
    max-age-hours: 24 # Eliminar huérfanos de más de 24 horas

# ============================================
# CACHE CONFIGURATION
# ============================================
spring.cache:
  type: caffeine
  caffeine:
    spec: maximumSize=500,expireAfterWrite=24h
  cache-names:
    - availableAdsCount
    - userPreferences
    - categories
    - departments
    - municipalities

# ============================================
# LOGGING CONFIGURATION
# ============================================
logging:
  level:
    root: INFO
    com.verygana2: DEBUG
    com.verygana2.repositories: DEBUG
    com.verygana2.services: INFO
    com.verygana2.services.storage: DEBUG
    #org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
    org.springframework.security: DEBUG

# ============================================
# Email service
# ============================================   
sendgrid:
  api-key: ${SENDGRID_API_KEY}
  from-email: notificaciones@verygana.com
  from-name: VerYGana
  support-email: soporte@verygana.com
# ============================================
# TAXES
# ============================================      
taxes:
  iva: ${IVA}
# ============================================
# PLATFORM EARNINGS
# ============================================ 
platformEarnings:
  product-commission : ${PRODUCT_SALE_COMMISSION}
# ============================================
# USERS EARNINGS
# ============================================  
usersEarnings:
  ad-view: ${AD_VIEW}

# ============================================
# GAMES CONFIG
# ============================================ 
games:
  cdn-url: ${GAMES_CDN_URL}
  user-hash-secret: ${USER_HASH_SECRET}
  session-expiration-minutes: 30

# ============================================
# WOMPI CONFIG
# ============================================ 
# Configuración de Wompi (se cambiará cuando se tenga la cuenta real)
wompi:
  public-key: ${WOMPI_PUBLIC_KEY:pub_test_EJEMPLO}
  private-key: ${WOMPI_PRIVATE_KEY:prv_test_EJEMPLO}
  event-secret: ${WOMPI_EVENT_SECRET:event_secret_EJEMPLO}
  api-url: ${WOMPI_API_URL:https://sandbox.wompi.co/v1}
  currency: COP
  
payment:
  min-deposit: 5000      # $5.000 COP
  max-deposit: 10000000  # $10.000.000 COP


# ============================================
# AUDIT CONFIG
# ============================================ 
audit:
  # Habilitar/deshabilitar auditoría
  enabled: true
  
  # Nivel mínimo para persistir (útil en dev)
  # DEBUG: solo para debugging local
  # INFO: operaciones normales
  # WARNING: operaciones sospechosas
  # CRITICAL: operaciones críticas
  min-level: INFO
  
  # Configuración de retención (días)
  retention:
    debug: 7
    info: 90
    warning: 365
    critical: 2555  # 7 años
  
  # Limpieza automática
  cleanup:
    enabled: true
    cron: "0 0 3 * * ?"  # 3 AM diario
    
  # Reportes
  reports:
    weekly:
      enabled: true
      cron: "0 0 8 * * MON"  # Lunes 8 AM
      recipients:
        - admin@verygana.com
        
  # Máscaras por defecto (además de las especificadas en @Auditable)
  default-mask-params:
    - password
    - confirmPassword
    - oldPassword
    - token
    - apiKey
    - secret
    - creditCard
    - ssn
    
  # Excluir de auditoría (no auditar aunque tenga @Auditable)
  excluded-actions:
    - HEALTH_CHECK
    - METRICS_COLLECTION
    
  # Configuración de async
  async:
    core-pool-size: 2
    max-pool-size: 10
    queue-capacity: 500
    thread-name-prefix: "audit-"

  # Sorteos con API externa (Random.org)
randomOrg:
    api-url: https://api.random.org/json-rpc/4/invoke
    api-key: ${RANDOM_ORG_API_KEY}
    timeout: 30000 # 30 segundos